<div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4">
  <div class="bg-white rounded-2xl shadow-2xl max-w-md w-full animate-fade-in-up">
    <!-- Header -->
    <div class="flex items-center justify-between p-6 border-b border-gray-200">
      <h2 class="text-xl font-bold text-gray-800">å¸³è™Ÿè¨­å®š</h2>
      <button (click)="closeDialog()" class="text-gray-400 hover:text-gray-600 transition-colors">
        <fa-icon [icon]="faTimes" class="text-lg"></fa-icon>
      </button>
    </div>

    <!-- Content -->
    <div class="p-6 space-y-6">
      <!-- ç”¨æˆ¶ä¿¡æ¯ -->
      @if (currentUser()) {
        <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
          <p class="text-sm text-gray-600 mb-2">å·²ç™»å…¥å¸³è™Ÿ</p>
          <p class="font-semibold text-gray-800">{{ currentUser()!.email }}</p>
          <p class="text-sm text-gray-600 mt-1">{{ currentUser()!.displayName }}</p>
        </div>
      }

      <!-- åˆªé™¤ç”³è«‹ç‹€æ…‹ -->
      @if (currentUser()?.deleteRequestedAt) {
        <div class="bg-red-50 rounded-lg p-4 border-l-4 border-red-500">
          <div class="flex items-start gap-3">
            <fa-icon [icon]="faWarning" class="text-red-500 text-lg flex-shrink-0 mt-0.5"></fa-icon>
            <div>
              <p class="font-semibold text-red-800 mb-1">å¸³è™Ÿåˆªé™¤ç”³è«‹å·²æäº¤</p>
              <p class="text-sm text-red-700 mb-2">
                å‰©é¤˜ <strong>{{ getRemainingDays() }}</strong> å¤©å°‡æ°¸ä¹…åˆªé™¤å¸³è™Ÿ
              </p>
              <p class="text-xs text-red-600">
                ç”³è«‹æ™‚é–“ï¼š{{ currentUser()!.deleteRequestedAt!.toDate() | date:'yyyy/MM/dd HH:mm' }}
              </p>
            </div>
          </div>
        </div>

        <!-- å–æ¶ˆåˆªé™¤æŒ‰éˆ• -->
        <button
          (click)="cancelDelete()"
          [disabled]="loading()"
          class="w-full px-4 py-3 bg-green-50 hover:bg-green-100 text-green-700 font-semibold rounded-lg transition-colors border border-green-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
          @if (loading()) {
            <fa-icon [icon]="faSpinner" class="animate-spin"></fa-icon>
            <span>è™•ç†ä¸­...</span>
          } @else {
            <fa-icon [icon]="faCheck"></fa-icon>
            <span>å–æ¶ˆåˆªé™¤ç”³è«‹</span>
          }
        </button>
      } @else {
        <!-- å±éšªå€åŸŸ -->
        <div class="border border-red-200 rounded-lg p-4 bg-red-50">
          <h3 class="font-semibold text-red-800 mb-2 flex items-center gap-2">
            <fa-icon [icon]="faWarning" class="text-lg"></fa-icon>
            å±éšªå€åŸŸ
          </h3>
          <p class="text-sm text-red-700 mb-4">
            ç”³è«‹åˆªé™¤å¸³è™Ÿå¾Œï¼Œæ‚¨çš„å¸³è™Ÿå°‡åœ¨ 7 å¤©å…§æ°¸ä¹…åˆªé™¤ã€‚æ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚
          </p>

          <button
            (click)="requestDelete()"
            [disabled]="loading()"
            class="w-full px-4 py-3 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2">
            @if (loading()) {
              <fa-icon [icon]="faSpinner" class="animate-spin"></fa-icon>
              <span>è™•ç†ä¸­...</span>
            } @else {
              <span>ç”³è«‹åˆªé™¤å¸³è™Ÿ</span>
            }
          </button>
        </div>

        <!-- æç¤º -->
        <div class="bg-blue-50 rounded-lg p-4 border border-blue-200">
          <p class="text-sm text-blue-800">
            <strong>ğŸ’¡ æç¤ºï¼š</strong>
            ç”³è«‹å¾Œæœ‰ 7 å¤©çš„å–æ¶ˆæœŸé™ã€‚å¦‚æœæ‚¨æ”¹è®Šä¸»æ„ï¼Œå¯ä»¥åœ¨é€™ 7 å¤©å…§å–æ¶ˆåˆªé™¤ç”³è«‹ã€‚
          </p>
        </div>
      }
    </div>

    <!-- Footer -->
    <div class="border-t border-gray-200 p-6">
      <button
        (click)="closeDialog()"
        class="w-full px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium rounded-lg transition-colors">
        é—œé–‰
      </button>
    </div>
  </div>
</div>
